CREATE DATABASE IGAPET;		-- nom temporaire pour pas supprimer IGAPET

USE IGAPET;

CREATE TABLE Users(
	UserID int PRIMARY KEY AUTO_INCREMENT,          -- principal key
	FirstName varchar(70),
	LastName varchar(70),
    Mail varchar(70) NOT NULL,		            	        -- should be unique
	CreationDate datetime NOT NULL,  		                -- automatic
    UserPassword varchar(255) NOT NULL,		                -- should be crypted + condition
	UserTypeID tinyint NOT NULL,
    Phone varchar(15),                			    -- should be unique
	NbrConnexion int(11) NOT NULL
);

CREATE TABLE Houses(
	HouseID int PRIMARY KEY AUTO_INCREMENT,         -- primary key
	UserID int NOT NULL,	                            -- foreign key
	Name varchar(50) NOT NULL,
	Address varchar(255) NOT NULL,                  -- change varcharSize
	PostalCode varchar(10) NOT NULL,
	Country varchar(30) NOT NULL,
	NumberOfFloor tinyint NOT NULL
);

CREATE TABLE Rooms(
	RoomID int PRIMARY KEY AUTO_INCREMENT,          -- primary key
	HouseID int,			                        -- foreign key
	Name varchar(30) NOT NULL,
	xPosition real,
	yPosition real,
	Width real NOT NULL,
	Height real NOT NULL,
	Floor tinyint			                        -- must be < HouseID->NumberOfFloor -1
);

CREATE TABLE Captors(
	CaptorID int PRIMARY KEY AUTO_INCREMENT,        -- primary key
	RoomID int NOT NULL, 				            	    -- foreign key
	CaptorTypeID int NOT NULL,  			            	    -- foreign key
	Value varchar(255) 		                	    -- modify according to precision
  
);

CREATE TABLE Actuators(
	ActuatorID int PRIMARY KEY AUTO_INCREMENT,	    -- primary key
	RoomID int NOT NULL,						                -- foreign key
	ActuatorTypeID int NOT NULL,			                    -- foreign key
	State varchar(255)		                	    -- modify according to precision
);

CREATE TABLE Scenarios(
	ScenarioID int PRIMARY KEY AUTO_INCREMENT,      -- primary key
	ActuatorID int NOT NULL,				                        -- foreign key
	CibleState varchar(255),		                -- modify according to precision
	ActionDate datetime
);

CREATE TABLE Notifications(
	NotificationID int PRIMARY KEY AUTO_INCREMENT,  -- primary key
	CaptorID int NOT NULL,					                -- foreign key
	Threshold varchar(255),			                -- modify according to precision
	ThresholdType varchar(1)		                -- < or >
);

CREATE TABLE UserTypes(
	UserTypeID int PRIMARY KEY AUTO_INCREMENT,	    -- primary key
	ParentUserID int,
	EditionAdmin varchar(1) DEFAULT (0),			      -- definir 0 comme admin et enlever cette ligne??
	ManageUsers varchar(1),
	AddScenarios varchar(1),
	AddNotifications varchar(1),
	ConsultNotifications varchar(1),
	ManageHouses varchar(1),
	CustomAutorisationsHouse varchar(255),
	CustomAutorisationsCaptor varchar(255)
);

CREATE TABLE CaptorTypes(
	CaptorTypeID int PRIMARY KEY AUTO_INCREMENT,    -- primary key
	CaptorName varchar(30),
	Unit varchar(10),
	url_img varchar(255)					        -- add more information? price,size,ect
);

CREATE TABLE ActuatorTypes(
	ActuatorTypeID int PRIMARY KEY AUTO_INCREMENT,  -- primary key
	ActuatorName varchar(30),
	Unit varchar(10),
	MinimumValue varchar(255),					    -- modify according to precision
	MaximumValue varchar(255),					    -- modify according to precision
	url_img varchar(255)
);

CREATE TABLE Page(
	PageID int PRIMARY KEY,		    -- primary key
	PageContent TEXT
);

CREATE TABLE Historic(
	HistoicID int PRIMARY KEY AUTO_INCREMENT,	    -- primary key (2,147,483,647 x 2  too small?)
	CaptorID int,
	Value varchar(255),				                -- modify according to precision
	Date datetime
);
